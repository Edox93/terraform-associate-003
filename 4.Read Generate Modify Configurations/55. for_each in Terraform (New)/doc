# Setting the base

By default, a resource block configures one real infrastructure object.

However, somethimes you want to manage several similar objects (like a fied pool of compute instances) without writing a separate block for each one.

# Terraform has two ways to do this: count and for_each


# Example: creating 5 IAM users

#If we want to crate multiple resources with diff configs, we have to add multiple diff resource blocks

#       Intro for for_each

# If a resource block includes a for_each meta argument whose value is a map or set of strings, Terraform creates one instance for each member of that map or set.

# Example 1 - for_each with SET
variable "user_names" {
    type = set(string)
    default = ["alice","bob","john","james"]
}

resource "aws_iam_user" "this" {
    for_each = var.user_names
    name = each.value
}


# Example 2 - for_each with MAP
variable "my-map" {
    default = {
        key = "value"
        key1 = "value1"
    }
}

resource "aws_instance" "web" {
  for_each      = var.my-map
  ami           = each.value
  instance_type = "t3.micro"

  tags = {
    Name = each.key
  }
}

# Point to Note
In block wher for_each is set, and additional each object is available
These object has two attributes

each.key
each.value

#   Example - for_each with Map
When for_each is used with map, we can make use of each object to extract both key and value from the given map.
